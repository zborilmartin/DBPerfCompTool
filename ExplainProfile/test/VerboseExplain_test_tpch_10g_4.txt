------------------------------ 
QUERY PLAN DESCRIPTION: 
------------------------------

Opt Vertica Options
--------------------
PLAN_OUTPUT_SUPER_VERBOSE


EXPLAIN VERBOSE -- $ID$
 -- TPC-H/TPC-R Order Priority Checking Query (Q4)
 -- Functional Query Definition
 -- Approved February 1998
 
 
 select  /*+ label(monitoring_tpch_query_4) */ o_orderpriority, count(*) as order_count from orders where o_orderdate >= date '1996-05-01' and o_orderdate < date '1996-05-01' + interval '3' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate ) group by o_orderpriority order by o_orderpriority LIMIT 1; -- using 1459869488 as a seed to the RNG

Access Path:
+-SELECT  LIMIT 1 [Cost: 566365.000000, Rows: 1.000000 Disk(B): 0.000000 CPU(B): 0.000000 Memory(B): 0.000000 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 31] (PATH ID: 0)
|  Output Only: 1 tuples
|  Sort Key: (ORDERS.O_ORDERPRIORITY)
|  LDISTRIB_UNSEGMENTED
| +---> GROUPBY HASH (SORT OUTPUT) (LOCAL RESEGMENT GROUPS) [Cost: 566365.000000, Rows: 5.000000 Disk(B): 0.000000 CPU(B): 27885864.000000 Memory(B): 390.000000 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 31] (PATH ID: 2)
| |      Aggregates: count(*)
| |      Group By: orders.O_ORDERPRIORITY
| |      Sort Key: (ORDERS.O_ORDERPRIORITY)
| |      LDISTRIB_SEGMENTED
| | +---> JOIN MERGEJOIN(inputs presorted) [Semi] [Cost: 565683.000000, Rows: 899544.000000 Disk(B): 4660337.777778 CPU(B): 197350731.070707 Memory(B): 178109552.000000 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 31] (PATH ID: 3)
| | |      Join Cond: (VAL(1) = orders.O_ORDERKEY)
| | |      Materialize at Output: orders.O_ORDERPRIORITY
| | |      Sort Key: (ORDERS.O_ORDERKEY)
| | |      LDISTRIB_SEGMENTED
| | | +-- Outer -> STORAGE ACCESS for orders [Cost: 67652.000000, Rows: 606061.000000 Disk(B): 0.000000 CPU(B): 0.000000 Memory(B): 0.000000 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 8] (PATH ID: 4)
| | | |      Column Cost Aspects: [ Disk(B): 240123904.000000 CPU(B): 120061952.000000 Memory(B): 124848484.848485 Netwrk(B): 0.000000 Parallelism: 1.000000 ]
| | | |      Projection: tpch_10g.ORDERS_super
| | | |      Materialize: orders.O_ORDERKEY
| | | |      Filter: ((orders.O_ORDERDATE >= '1996-05-01'::date) AND (orders.O_ORDERDATE < '1996-08-01 00:00:00'::timestamp))/* sel=0.040404 ndv= 101 */
| | | |      Runtime Filter: (SIP1(MergeJoin): orders.O_ORDERKEY)
| | | |      Sort Key: (ORDERS.O_ORDERKEY)
| | | |      LDISTRIB_SEGMENTED
| | | +-- Inner -> SELECT [Cost: 483378.000000, Rows: 22263694.000000 Disk(B): 0.000000 CPU(B): 0.000000 Memory(B): 0.000000 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 8] (PATH ID: 5)
| | | |      Sort Key: (LINEITEM.L_ORDERKEY, LINEITEM.L_LINENUMBER)
| | | |      LDISTRIB_UNSEGMENTED
| | | | +---> STORAGE ACCESS for lineitem [Cost: 483378.000000, Rows: 22263694.000000 Disk(B): 0.000000 CPU(B): 1439665248.000000 Memory(B): 534328638.270657 Netwrk(B): 0.000000 Parallelism: 1.000000] [OutRowSz (B): 24] (PATH ID: 6)
| | | | |      Column Cost Aspects: [ Disk(B): 1441136640.000000 CPU(B): 0.000000 Memory(B): 1439665248.000000 Netwrk(B): 0.000000 Parallelism: 1.000000 ]
| | | | |      Projection: tpch_10g.LINEITEM_super
| | | | |      Materialize: lineitem.L_COMMITDATE, lineitem.L_RECEIPTDATE, lineitem.L_ORDERKEY
| | | | |      Filter: (lineitem.L_COMMITDATE < lineitem.L_RECEIPTDATE)
| | | | |      Sort Key: (LINEITEM.L_ORDERKEY, LINEITEM.L_LINENUMBER)
| | | | |      LDISTRIB_SEGMENTED


------------------------------ 
----------------------------------------------- 
Plan Extras
----------------------------------------------- 


digraph G {
graph [rankdir=BT, label = "JoinGraph(Base)\nGuaranteed Uniqueness: \n(orders.O_ORDERPRIORITY)", labelloc=t, labeljust=l ]
node140323318060064_0[label = "node 0 orders (tpch_10g.ORDERS)\noid 45035996330892178 varno = 1\npreds: \n((orders.O_ORDERDATE \>= \'1996-05-01\'::date) AND (orders.O_ORDERDATE \< \'1996-08-01 00:00:00\'::timestamp))", color = "black"];
node140323318060064_1[label = "node 1 <Unknown Alias> (tpch_10g.LINEITEM)\noid 0 varno = 2", color = "black"];
node140323318060064_0 -> node140323318060064_1[dir="forward" label="\nJoin preds: \n(VAL(1) = orders.O_ORDERKEY)\nUnique: 0 \nNot Null: 0 \nprops: [Directed][SJ]"];
subgraph cluster140326064380160 { 
style=filled; 
color=gray80; 
label = "subquery for node 1"
node140326064380160_0[label = "node 0 lineitem (tpch_10g.LINEITEM)\noid 45035996330892182 varno = 1\npreds: \n(lineitem.L_COMMITDATE \< lineitem.L_RECEIPTDATE)", color = "black"];
}
}

Table Name -> JoinGraph Node Mappings: 
tpch_10g.ORDERS: Node 0(JoinGraph ID: 1)
tpch_10g.LINEITEM: Node 1(JoinGraph ID: 1)
tpch_10g.LINEITEM: Node 0(JoinGraph ID: 2)

Join Descriptions: 
(tpch_10g.ORDERS x tpch_10g.LINEITEM(JoinGraph ID: 1)


Projections chosen for tables: 
     tpch_10g.ORDERS: ORDERS_super
   tpch_10g.LINEITEM: LINEITEM_super

Simplified Join Order:
-----------------------


digraph G {
graph [label = "Simplified Join Order: \n(1,0) [orders] --> ORDERS_super for tpch_10g.ORDERS\n(2,0) [lineitem] --> LINEITEM_super for tpch_10g.LINEITEM\n", labelloc=t, labeljust=l ] 
0[shape = "record" label = "SELECT"];
0->1 [label = "" color = "black" ];
1[shape = "record" label = "SORT"];
1->2 [label = "" color = "black" ];
2[shape = "record" label = "GROUPBY"];
2->3 [label = "" color = "black" ];
3[shape = "record" label = "MJO:(1,0)I: "];
3->4 [label = "" color = "black" ];
4[shape = "record" label = "P(1,0)"];
3->5 [label = "" color = "black" ];
5[shape = "record" label = "SELECT"];
5->6 [label = "" color = "black" ];
6[shape = "record" label = "P(2,0)"];
}



----------------------------------------------- 
PLAN: BASE QUERY PLAN (GraphViz Format)
----------------------------------------------- 
digraph G {
graph [rankdir=BT, label = "BASE QUERY PLAN\nQuery: EXPLAIN VERBOSE -- $ID$\n -- TPC-H/TPC-R Order Priority Checking Query (Q4)\n -- Functional Query Definition\n -- Approved February 1998\n \n \n select  /*+ label(monitoring_tpch_query_4) */ o_orderpriority, count(*) as order_count from orders where o_orderdate \>= date \'1996-05-01\' and o_orderdate \< date \'1996-05-01\' + interval \'3\' month and exists ( select * from lineitem where l_orderkey = o_orderkey and l_commitdate \< l_receiptdate ) group by o_orderpriority order by o_orderpriority LIMIT 1; -- using 1459869488 as a seed to the RNG\n\nAll Nodes Vector: \n\n  node[0]=v_verticadb_node0001 (initiator) Up\n", labelloc=t, labeljust=l ordering=out]
0[label = "Root \nNode Set: [Name: v_verticadb_node0001 , index: 0 , (initiator))]\nNode ID: 0", color = "green", shape = "house"];
1[label = "NewEENode \nOutBlk=[UncTuple<char(15).15, int>]\nNode Set: [Name: v_verticadb_node0001 , index: 0 , (initiator))]\nNode ID: 0", color = "green", shape = "box"];
2[label = "TopK[PIPELINED]\n Sort: (keys = )\nLIMIT: 1\nOffset: 0\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: \<SVAR\>[100,-3] - Integer(8)", color = "green", shape = "box"];
3[label = "ParallelMergeStep: 1 sorted\n Sort: (keys = A)\nthreads 3\nCombine\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "green", shape = "box"];
4[label = "GroupByHash(Sort Groups)(Spill): 1 keys\nAggs:\n  count(*)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "green", shape = "box"];
5[label = "StorageUnionStep: ORDERS_super\nstartEpoch 0\nendEpoch 2756569\nthreads 3\nLocally Resegment By: ((100 \<*\> 69069) \<+\> internal_strhash(orders.O_ORDERPRIORITY))\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "purple", shape = "box"];
6[label = "GroupByPipe(HashPrepass): 1 keys\nAggs:\n  count(*)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "brown", shape = "box"];
7[label = "ExprEval: \n  orders.O_ORDERPRIORITY\n  1\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "brown", shape = "box"];
8[label = "Join: Merge-Join: \n(tpch_10g.ORDERS x tpch_10g.LINEITEM) using ORDERS_super and subquery (PATH ID: 3)\nflags: [JF_SEMI][JF_PRESERVE_OUTER_INPUT_ORDER][JF_OUTER_JK_SORTED][JF_INNER_JK_SORTED]\n  orders.O_ORDERKEY<==>VAL(1)\nSIPExpr Ids: 1\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: O_ORDERPRIORITY[1,6] - Char(15)\nUnc: VAL(2)[2,1] - Integer(8)", color = "brown", shape = "box"];
9[label = "ScanStep: ORDERS_super\n((orders.O_ORDERDATE \>= \'1996-05-01\'::date) AND (orders.O_ORDERDATE \< \'1996-08-01 00:00:00\'::timestamp))\nSIP1(MergeJoin): orders.O_ORDERKEY\nVALINDEX[0]\nstartEpoch 0\nendEpoch 2756569\nO_ORDERKEY\nO_ORDERDATE (not emitted)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: O_ORDERKEY[1,1] - Integer(8)", color = "brown", shape = "box"];
10[label = "ExprEval: \n  lineitem.L_ORDERKEY\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: lineitem.L_ORDERKEY[2,1] - Integer(8)", color = "green", shape = "box"];
11[label = "StorageMergeStep: LINEITEM_super; 1 sorted\nstartEpoch 0\nendEpoch 2756569\nthreads 3\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: L_ORDERKEY[1,1] - Integer(8)\nUnc: L_COMMITDATE[1,12] - Date(8)\nUnc: L_RECEIPTDATE[1,13] - Date(8)", color = "purple", shape = "box"];
12[label = "ScanStep: LINEITEM_super\n(lineitem.L_COMMITDATE \< lineitem.L_RECEIPTDATE)\nVALINDEX[0]\nstartEpoch 0\nendEpoch 2756569\nL_ORDERKEY\nL_COMMITDATE\nL_RECEIPTDATE\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: L_ORDERKEY[1,1] - Integer(8)\nUnc: L_COMMITDATE[1,12] - Date(8)\nUnc: L_RECEIPTDATE[1,13] - Date(8)", color = "brown", shape = "box"];
1->0 [label = "V[0] S=0, D=0",color = "black"];
1->0 [label = "V[0] S=1, D=1",color = "black"];
2->1 [label = "0",color = "blue"];
3->2 [label = "0",color = "blue"];
4->3 [label = "0",color = "blue"];
5->4 [label = "0",color = "blue"];
6->5 [label = "0",color = "blue"];
7->6 [label = "0",color = "blue"];
8->7 [label = "0",color = "blue"];
9->8 [label = "0",color = "blue"];
10->8 [label = "1",color = "blue"];
11->10 [label = "0",color = "blue"];
12->11 [label = "0",color = "blue"];
}
Estimated resources for plan:
-----------------------------
Scratch Memory MB: 3370
File Handles:      39
Worker Threads:    37
Blocking Threads:  0
Externalizing Ops: 4
Unbounded Mem Ops: 0
Max Threads:     3

Extra Memory Reservation MB 0
-----------------------------
----------------------------------------------- 
PLAN:  ANNOTATED BY DISTRIBUTOR  (GraphViz Format)
----------------------------------------------- 
digraph G {
graph [rankdir=BT, label = " ANNOTATED BY DISTRIBUTOR \n", labelloc=t, labeljust=l ordering=out]
0[label = "Root \nOutBlk=[UncTuple<char(15).15, int>]\nNode Set: [Name: v_verticadb_node0001 , index: 0 , (initiator))]\nNode ID: 0", color = "green", shape = "house"];
1[label = "NewEENode \nOutBlk=[UncTuple<char(15).15, int>]\nNode Set: [Name: v_verticadb_node0001 , index: 0 , (initiator))]\nNode ID: 0", color = "green", shape = "box"];
2[label = "TopK[PIPELINED]\n Sort: (keys = )\nLIMIT: 1\nOffset: 0\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: \<SVAR\>[100,-3] - Integer(8)", color = "green", shape = "box"];
3[label = "ParallelMergeStep: 1 sorted\n Sort: (keys = A)\nthreads 3\nCombine\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "green", shape = "box"];
4[label = "GroupByHash(Sort Groups)(Spill): 1 keys\nAggs:\n  count(*)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "green", shape = "box"];
5[label = "StorageUnionStep: ORDERS_super\nstartEpoch 0\nendEpoch 2756569\nthreads 3\nLocally Resegment By: ((100 \<*\> 69069) \<+\> internal_strhash(orders.O_ORDERPRIORITY))\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "purple", shape = "box"];
6[label = "GroupByPipe(HashPrepass): 1 keys\nAggs:\n  count(*)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "brown", shape = "box"];
7[label = "ExprEval: \n  orders.O_ORDERPRIORITY\n  1\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: orders.O_ORDERPRIORITY[1,6] - Char(15)\nUnc: count(*)[100,-3] - Integer(8)", color = "brown", shape = "box"];
8[label = "Join: Merge-Join: \n(tpch_10g.ORDERS x tpch_10g.LINEITEM) using ORDERS_super and subquery (PATH ID: 3)\nflags: [JF_SEMI][JF_PRESERVE_OUTER_INPUT_ORDER][JF_OUTER_JK_SORTED][JF_INNER_JK_SORTED]\n  orders.O_ORDERKEY<==>VAL(1)\nSIPExpr Ids: 1\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: O_ORDERPRIORITY[1,6] - Char(15)\nUnc: VAL(2)[2,1] - Integer(8)", color = "brown", shape = "box"];
9[label = "ScanStep: ORDERS_super\n((orders.O_ORDERDATE \>= \'1996-05-01\'::date) AND (orders.O_ORDERDATE \< \'1996-08-01 00:00:00\'::timestamp))\nSIP1(MergeJoin): orders.O_ORDERKEY\nVALINDEX[0]\nstartEpoch 0\nendEpoch 2756569\nO_ORDERKEY\nO_ORDERDATE (not emitted)\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: O_ORDERKEY[1,1] - Integer(8)", color = "brown", shape = "box"];
10[label = "ExprEval: \n  lineitem.L_ORDERKEY\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: lineitem.L_ORDERKEY[2,1] - Integer(8)", color = "green", shape = "box"];
11[label = "StorageMergeStep: LINEITEM_super; 1 sorted\nstartEpoch 0\nendEpoch 2756569\nthreads 3\nnodeSet: [0] \n[Local Segmented Properties: UNSEGMENTED]\nUnc: L_ORDERKEY[1,1] - Integer(8)\nUnc: L_COMMITDATE[1,12] - Date(8)\nUnc: L_RECEIPTDATE[1,13] - Date(8)", color = "purple", shape = "box"];
12[label = "ScanStep: LINEITEM_super\n(lineitem.L_COMMITDATE \< lineitem.L_RECEIPTDATE)\nVALINDEX[0]\nstartEpoch 0\nendEpoch 2756569\nL_ORDERKEY\nL_COMMITDATE\nL_RECEIPTDATE\nnodeSet: [0] \n[Local Segmented Properties: SEGMENTED]\nUnc: L_ORDERKEY[1,1] - Integer(8)\nUnc: L_COMMITDATE[1,12] - Date(8)\nUnc: L_RECEIPTDATE[1,13] - Date(8)", color = "brown", shape = "box"];
1->0 [label = "V[0] S=0, D=0",color = "black"];
1->0 [label = "V[0] S=1, D=1",color = "black"];
2->1 [label = "0",color = "blue"];
3->2 [label = "0",color = "blue"];
4->3 [label = "0",color = "blue"];
5->4 [label = "0",color = "blue"];
6->5 [label = "0",color = "blue"];
7->6 [label = "0",color = "blue"];
8->7 [label = "0",color = "blue"];
9->8 [label = "0",color = "blue"];
10->8 [label = "1",color = "blue"];
11->10 [label = "0",color = "blue"];
12->11 [label = "0",color = "blue"];
}
Estimated resources for plan:
-----------------------------
Scratch Memory MB: 3370
File Handles:      39
Worker Threads:    37
Blocking Threads:  0
Externalizing Ops: 4
Unbounded Mem Ops: 0
Max Threads:     3

Extra Memory Reservation MB 0
-----------------------------
